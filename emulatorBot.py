import timeimport osfrom pynput import keyboardimport subprocessfrom PIL import ImageEMULATOR_STRING = "emulator-"# EMULATORS = [5554, 5556, 5558, 5560]selected_emulator = ""emulator_list = []# ScreenshotSCREENSHOT_NAME = "screenshot.png"CROPPED_SCREENSHOT = "cropped_screenshot.png"SCREENSHOT_PATH = os.path.join(os.path.dirname(__file__), SCREENSHOT_NAME)# Adad_has_been_found = FalseORIGINAL_TV_IMAGE = "tv.png"TV_LOCATION = {'x': 188, 'y': 277}TV_IMAGE_POSITION = {'left': 50, 'top': 200, 'right': 300, 'bottom': 375}# Close addef crop_screenshot(dimensions):    # Load the two images you want to compare    image_before = Image.open(SCREENSHOT_NAME)    cropped_image = image_before.crop(        (dimensions['left'], dimensions['top'], dimensions['right'], dimensions['bottom']))    # Save the cropped image    cropped_image.save(CROPPED_SCREENSHOT)def click_on_ad(emulator):    perform_click(emulator, TV_LOCATION['x'], TV_LOCATION['y'])def click_exit_ad(emulator):    perform_click(emulator, 1013, 55)def perform_click(emulator, x_pos, y_pos):    adb_command = f"adb -s {EMULATOR_STRING + str(emulator)} shell input tap {x_pos} {y_pos}"    subprocess.run(adb_command, shell=True)def take_screenshot(emulator):    adb_command = f"adb -s {EMULATOR_STRING + str(emulator)} exec-out screencap  -p > {SCREENSHOT_PATH}"    subprocess.run(adb_command, shell=True)def get_emulators():    emulator_list.clear()    adb_command = f"adb devices"    result = subprocess.run(adb_command, capture_output=True, text=True, check=True, shell=True)    if len(result.stdout) > 0:        for line in result.stdout.split("\n"):            if "emulator-" in line:                emulator_list.append({'emulator': line.split("\t")[0], 'state': line.split("\t")[1]})def check_emulator_offline(emulator):    if emulator['state'] == "offline":        print(f"EMULATOR {emulator['emulator']} IS OFFLINE")        return Trueif __name__ == '__main__':    # get all emulators and check their state    get_emulators()    if len(emulator_list) == 0:        print("No running emulators, exiting")        exit(1)    for emulator in emulator_list:        check_emulator_offline(emulator)    # infinite loop    while (True):        for emulator in emulator_list:            # check if its online            if not check_emulator_offline(emulator):                # Look for TV ad                take_screenshot(5554)                if ad_has_been_found:                    while True:                        pass