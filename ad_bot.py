import timeimport threadingfrom common import constants as constfrom common import common_utils as utilfrom common import adb_utils as adbutilfrom common import os_utils as osutilfrom common import image_utils as imgutilfrom common import check_utils as checkfrom common.custom_logger import logger, DEBUG_LEVELdef check_device_loop(emulator):    logger.info(f"Running loop for: {emulator}")    start_time = 0.0    last_ad_timer = 0.0    while True:        try:            imgutil.take_screenshot(emulator)            if check.is_in_game(emulator):                if check.is_in_tavern(emulator):                    if check.is_ad_present(emulator):                        if start_time > 0 and (time.time() - start_time < 4):                            adbutil.close_game(emulator)                            time.sleep(5)                            start_time = 0.0                        else:                            start_time = time.time()                            util.watch_ad_and_close_after(emulator)                            last_ad_timer = time.time()                    else:                        util.close_ad_if_playing(emulator)                        if last_ad_timer > 0 and (time.time() - last_ad_timer > 2000):                            adbutil.close_game(emulator)                            time.sleep(5)                            last_ad_timer = 0.0                else:                    util.close_ad_if_playing(emulator)            else:                util.open_game(emulator)                util.go_to_tavern_using_key(emulator)        except Exception as e:            logger.error(f"[{emulator.serial}]: emulation failed")            exit(1)if __name__ == '__main__':    logger.setLevel(DEBUG_LEVEL)    logger.info("Started Shakes_AD_Bot")    osutil.check_cli_tools_installed()    osutil.clean_screenshots()    thread_list = []    SKIP_EMULATORS = []    emulator_device_list = adbutil.filter_emulators(adbutil.get_adb_client().device_list(), SKIP_EMULATORS)    adbutil.check_emulator_list(emulator_device_list)    for device in emulator_device_list:        thread = threading.Thread(target=check_device_loop, args=(device,))        thread.start()        thread_list.append(thread)    for thread in thread_list:        thread.join()