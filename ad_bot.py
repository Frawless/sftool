import timeimport threadingfrom common import constants as constfrom common import common_utils as utilfrom common import adb_utils as adbutilfrom common import os_utils as osutilfrom common import image_utils as imgutilfrom common import check_utils as checkfrom common.custom_logger import logger, DEBUG_LEVELdef check_device_loop(emulator):    logger.info(f"Running loop for: {emulator}")    start_time = 0.0    tries = 0    while True:        try:            util.open_game_if_not_opened(emulator)            imgutil.take_screenshot(emulator)            if check.is_ad_present(emulator):                if tries > 5:                    tries = 0                    util.reopen_game(emulator)                if start_time > 0 and time.time() - start_time < 5:                    tries += 1                else:                    start_time = time.time()                    util.watch_ad_and_close_after(emulator)            else:                if start_time > 0 and time.time() - start_time > 60:                    util.reopen_game(emulator)                    start_time = time.time()                if check.is_dont_close_ad_button_present(emulator) and not check.is_in_tavern(emulator):                    util.go_to_tavern_using_key(emulator)                else:                    util.close_ad_if_playing(emulator)        except Exception as e:            logger.error(f"[{emulator.serial}]: emulation failed")            exit(1)if __name__ == '__main__':    logger.setLevel(DEBUG_LEVEL)    logger.info("Started Shakes_AD_Bot")    osutil.check_cli_tools_installed()    osutil.clean_screenshots()    thread_list = []    SKIP_EMULATORS = []    emulator_device_list = adbutil.filter_emulators(adbutil.get_adb_client().device_list(), SKIP_EMULATORS)    adbutil.check_emulator_list(emulator_device_list)    for device in emulator_device_list:        thread = threading.Thread(target=check_device_loop, args=(device,))        thread.start()        thread_list.append(thread)    try:        for thread in thread_list:            thread.join()    except Exception:        logger.info("fail")